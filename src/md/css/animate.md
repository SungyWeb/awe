---
title: "前端动效"
date: "2022-11-18"
path: "/css-animate"
tag: "react"
---

# 背景

前端动画场景需求很多，有些朋友技术实现方案也不知道怎么选，下面从各个角度对动画整体体系进行分类，让我们清晰的了解动画整个体系。

# 分类

## 业务角度

从业务角度来说，动画可分为展示型和交互型。

- 展示型动画 类似 Gif 图片或者一段视频，来增加用户的视觉体验，主要特点体现在用户可以感知，但无法参与。实现方式有 Gif、canvas、CSS3 动画等。

- 交互型动画 在动画播放的过程中用户可以进行操作，如点击、滑动等。但是通过原生代码实现交互动画是很复杂的，同时性能和兼容性也不容忽视，比较好的方案还是寻求相关框架。

## 绘制技术角度

不管采用什么方式来制作动画，最终呈现到前端的页面无非是三种形式： `div` `cavas` `svg`。为了简单也可以使用视频，除非动画的播放场景固定，不然很容易踩坑。

### canvas

- 👍 效率高、性能好、可控制高
- 👍 能够以`png`或`jpg`格式保存图像
- 👍 逐像素渲染，适合图像密集的场景，许多对象会被频繁重绘
- 👎 不支持事件处理器
- 👎 文本渲染能力弱

### div

- 👍 Dom 动画，可以通过 css 或 js 实现
- 👍 适合简单的、数量少的、复杂度低的动画场景

### svg

- 👍 基于`xml`的 2D 图形，矢量图，不会失真，不依赖分辨率
- 👍 支持时间处理器，精确控制任意元素，且 svg 对象属性变化时，浏览器能够自动重绘
- 👍 适合大型渲染区域的应用程序（如地图）
- 👎 复杂度高会影响渲染速度（任何过度使用 dom 的应用都不快）
- 👎 不适合游戏应用

总体来说，canvas 和 svg 都是 2D 作图，svg 是矢量图，适合复杂度不高的应用场景；canvas 是位图，逐像素渲染，适合游戏。

## 动画类型

### 序列帧动画

将静态的图片进行快速的播放，形成一个动态的动画效果。

GIF 实现

- 画质不佳，颜色支持少，最多 256 色，透明度支持差
- 不能直接控制播放、暂停、播放次数等，灵活性差
- 会引起页面周期性的绘制，性能比较差

连续切换图片地址（不推荐）

- 多张图片会带来多个 http 请求
- 每张图片首次加载时会造成图片切换的闪烁
- 不利于文件管理

连续切换雪碧图位置（推荐）

- 可以通过 css、js 控制 dom 或 js 绘制 canvas 实现
- 推荐通过`transform:translate3d()`实现雪碧图位置变化，启动设备`GPU`来提高性能
- 注意`animation`的`animation-timing-function`要采用阶梯函数`steps()`来实现逐帧动画的连续播放

### 关键帧动画

在制作动画时，只需要指定几个特殊时刻动画的状态，其余的状态由计算机自动计算补充

- CSS3 Animation 通过除了`steps()`之外的时间函数实现
- CSS3 Transition 只能设定初始和结束两个关键帧状态，一条`transition`只能指定一个属性（`all`除外）
- 使用 js 动画库或框架，比如[Anime.js](https://animejs.com/documentation/)

### svg 动画

SVG 依然是 DOM ，他有自己独有的 Animation 标签，但也支持 CSS 的属性，其实现动画的本质是依赖于线条和填充，线条的变化，导致填充区域的改变，从而引起形状的变化。而线条则依赖于路径和锚点，路径和锚点的改变，直接影响了线条的变化。

可以用 AI 等 SVG 编辑工具生成 SVG 图片后，配合[Anime.js](https://animejs.com/documentation/)、[GSAP](https://greensock.com/)等现有库进行动画制作

### 骨骼动画

骨骼动画就是把角色的各部分身体部件图片绑定到一根根互相作用连接的“骨头”上，通过控制这些骨骼的位置、旋转方向和放大缩小而生成的动画。

可以使用类似 [Spine](http://zh.esotericsoftware.com/) 和 [DragonBones](https://dragonbones.github.io/cn/index.html) 这样的工具，但是做动画真的是一个体力活，你需要不断的调试，以求达到一种让人看起来舒服的状态。

### 3D 动画

前端 3D 动画实现可以通过 perspective 属性操作用 CSS 3D 来实现，或者直接借助开源的 Three.js 开源库进行实现。

# 总结

## 简单的展示型动画：

对于比较简单的动画，我们可以先尝试使用原生 CSS 的 transition\animation 属性来进行实现。

## 简单的展示型动画+弱交互：

对于简单的动画展示并且需要有简单的交互行为，比如用户点击一下暂停执行相应操作，待操作完成继续播放动画，交互方面比较偏弱，可以采用 Anime.js 的方案。

Anime.js 不仅仅支持所有的 CSS 属性，而且可以通过 Timeline，callback， playback controls 来控制动画执行的各个状态，并且 Anime.js 可以配合实现 SVG 动画。

## 复杂的展示型动画：

如果所需的资源很小，可以先考虑使用 GIF 动图或者逐帧动画 CSS 实现；

如果所需的资源较大，可以使用 Lottie 方案，然后设计同学用 AE 到处动画 json，将动画还原为 svg/canvas/html。

## 强交互&互动小游戏&骨骼动画：

对于交互场景比较负责或者需要做一个小游戏，可以采用 PixiJs，通过 WebGL 来渲染，利用硬件资源，极大的提升性能，在兼容性方面，对于不支持 WebGL 的浏览器，可以使用 canvas 渲染来平稳回退；

如果是需要展示骨骼动画，可以通过 PixiJs 方案进行渲染由 Spine 或 DragonBones 输出的文件。
